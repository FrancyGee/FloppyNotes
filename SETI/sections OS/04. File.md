---
title: 04. File
date: 2023-01-12
tags: SETI-OS, file, permission
difficulty: üü¢
---

<h1  style="text-align: center;">  04. File üìÑ </h1> 

Su Linux ogni cosa √® un file, ogni file ha:
- un **file descriptor**
- dei **permessi (read, write, execute)**
- un **owner**

Per ottenere informazioni riguardanti il file utilizziamo la syscall:
```c
int stat(const char *pathname, struct stat *statbuf);

int lstat(const char *pathname struct stat *statbuf);

int fstat(int fd, struct stat *statbuf);
```
Consultare il **man** per maggiori informazioni.

# Permessi

Ogni file ha tre tipi di permessi:
- **Read (r)**
- **Write (w)**
- **Execute (x)**

Questi tre permessi possono essere rappresentati con tre bit:

| **string** | **bit** | **valore numerico** | **valore singolo** |
| ---------- | ------- | ------------------- | ------------------ |
| ---        | 000     | 000                 | 0                  |
| --x        | 001     | 001                 | 1                  |
| -w-        | 010     | 020                 | 2                  |
| -wx        | 011     | 021                 | 3                  |
| r--        | 100     | 400                 | 4                  |
| r-x        | 101     | 401                 | 5                  |
| rw-        | 110     | 420                 | 6                  |
| rwx        | 111     | 421                 | 7                  |


Ogni permesso viene affidato a 3 diversi livelli:
- **User permission (u)**
	- I permessi per l'utente
- **Group permission (g)***
	- I permessi per il gruppo
- **Others permission (o)**
	- il permesso per tutti gli altri utenti


![[Pasted image 20230111155106.png|center|400]]

Un esempio:
```bash
drwxr-xr-x     - floppy 11 Jan 15:48  dir/
.rwxr-xr-x     0 floppy 11 Jan 15:48  executable
.rw-r--r--   792 floppy 11 Jan 11:35  main.py
```
Il `.` e la `d` a inizio riga indicano se sia un file o una directory

Per cambiare i permessi di un file utilizzare `chmod`.
Per cambiare il proprietario di un file utilizzare `chown`.


# Offset

Ogni file che viene aperto ha un **file offset/pointer** che indica la posizione nel quale scrivere.
Di default l'offset √® a 0 e si sposta con le syscall `read` e `write`.
Possiamo settare la posizione dell'offset con la syscall:
```c
off_t lseek(int fd, off_t offset, int whence);
```

Possiamo spostare l'offset oltre la fine del file (**EOF**), questo non andr√† a modificare  la dimensione del file, infatti le righe che avremo *"skippato"* saranno **riempiti da byte a 0**.

Il comando:
```bash
xxd -g 1 <nome-file>
```
Ci mostra il contenuto del file in esadecimale.


# Limiti

Ogni filesystem ha le sue limitazioni ad esempio:
- La lunghezza massima.
- Case-sensitive.
- Nomi non utilizzabili (riservati al sistema).

# Linking

- [ ] Completare il capitolo sul Linking [[2023-01-12]]



# [[03.System Call|‚Üê Prev]] | [[05. Processi| Next ‚Üí]]






# Flashcards

Cosa si usa per cambiare i permessi del file:: `chmod`

Cosa si usa per cambiare il proprietario del file:: `chown`

Che tipi di permessi ha un file
?
- **Read (r)**
- **Write (w)**
- **Execute (x)**

Quanti bit servono per rappresentare i permessi di un file:: 3 bit.

Quali sono i tre livelli di permessi
?
- **User (u)**
- **Group User (g)**
- **Others (o)**

Quali permessi gestisce il livello **User**:: i permessi dell'utente

Quali permessi gestisce il livello **Group**:: i permessi del gruppo dell'utente

Quali permessi gestisce il livello **User**:: i permessi degli altri utenti

Cos'√® l'**offset pointer**:: Il puntatore alla posizione corrente del file.

